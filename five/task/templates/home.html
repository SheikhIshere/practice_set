{% extends "base.html" %}
{% block title %}All Tasks{% endblock %}
{% block content %}
<h1 class="mb-4">All Tasks</h1>

{% for task in tasks %}
<div class="card mb-3 shadow-sm">
    <div class="card-body">
        <h5 class="card-title">{{ task.title }} <small class="text-muted">({{ task.get_category_display }})</small></h5>
        <p class="card-text">{{ task.description }}</p>
        <p class="mb-1">By: <a href="{% url 'accounts:profile' username=task.owner.username %}">{{ task.owner.username }}</a></p>
        <p>Status: <span class="badge {% if task.is_done %}bg-success{% else %}bg-warning{% endif %}">{{ task.is_done|yesno:"Done,Not Done" }}</span></p>
        <p>Likes: {{ task.total_likes }}</p>

        {% if user.is_authenticated %}
            <a href="{% url 'task:task_like' task.id %}" class="btn btn-outline-primary btn-sm">Like/Unlike</a>
        {% endif %}

        {% if task.owner == user %}
            <a href="{% url 'task:task_edit' task.id %}" class="btn btn-outline-secondary btn-sm">Edit</a>
            <a href="{% url 'task:task_delete' task.id %}" class="btn btn-outline-danger btn-sm">Delete</a>
        {% endif %}
    </div>
</div>
{% empty %}
    <p class="text-muted">No tasks yet.</p>
{% endfor %}
{% endblock %}
